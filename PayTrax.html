<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PayTrax</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>PayTrax</h1>
            <p>Track. Calculate. Comply.</p>
        </div>

        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="dashboard">Dashboard</button>
            <button class="nav-tab" data-tab="settings">Settings</button>
            <button class="nav-tab" data-tab="payroll">Pay Periods</button>
            <button class="nav-tab" data-tab="paystub">Pay Stub</button>
            <button class="nav-tab" data-tab="reports">Reports</button>
            <button class="nav-tab" data-tab="banking">Banking</button>
        </nav>

        <div id="dashboard" class="tab-content active">
            <div class="card">
                <div class="card-header">
                    <span class="status-indicator status-active"></span>
                    Payroll Dashboard
                </div>
                <div class="card-body">
                    <div class="alert alert-info">
                        <strong>Quick Start:</strong> Add employees in Settings, then select an employee and pay period here to enter hours.
                    </div>
                    
                    <div class="form-grid">
                         <div class="form-group">
                            <label class="form-label">Select Employee</label>
                            <select id="currentEmployee" class="form-input">
                                <option value="">Select Employee...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Current Pay Period</label>
                            <select id="currentPeriod" class="form-input">
                                <option value="">Select Pay Period...</option>
                            </select>
                        </div>
                    </div>

                     <div class="card" style="margin-top: 20px;">
                        <div class="card-header" style="background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);">Enter Hours for Period</div>
                        <div class="card-body">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">Regular Hours</label>
                                    <input type="number" id="regularHours" class="form-input" placeholder="e.g., 40" step="0.25">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Overtime Hours</label>
                                    <input type="number" id="overtimeHours" class="form-input" placeholder="e.g., 5" step="0.25">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Paid Time Off (PTO) Hours</label>
                                    <input type="number" id="ptoHours" class="form-input" placeholder="e.g., 8" step="0.25">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Holiday Hours</label>
                                    <input type="number" id="holidayHours" class="form-input" placeholder="e.g., 8" step="0.25">
                                </div>
                            </div>
                        </div>
                    </div>


                    <div id="periodDetails" style="display: none;" class="card">
                        <div class="card-body">
                            <h4>Pay Period Details</h4>
                            <div class="form-grid">
                                <div><strong>Period:</strong> <span id="periodNumber"></span></div>
                                <div><strong>Start Date:</strong> <span id="startDate"></span></div>
                                <div><strong>End Date:</strong> <span id="endDate"></span></div>
                                <div><strong>Pay Date:</strong> <span id="payDate"></span></div>
                                <div><strong>PTO Balance:</strong> <span id="ptoBalanceDisplay" style="font-weight: bold; color: #0056b3;">0.00</span> hours</div>
                            </div>
                            
                            <div class="form-grid">
                                <div><strong>Gross Pay:</strong> $<span id="grossPay">0.00</span></div>
                                <div><strong>Total Employee Taxes:</strong> $<span id="totalTaxes">0.00</span></div>
                                <div><strong>Net Pay:</strong> $<span id="netPay">0.00</span></div>
                                <div><strong>Employer Taxes:</strong> $<span id="employerTaxes">0.00</span></div>
                                <div><strong>Total Payroll Cost:</strong> $<span id="totalPayrollCost">0.00</span></div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">Bank Funds Required</div>
                        <div class="card-body">
                            <div class="form-grid">
                                <div class="summary-box" style="border-color: #000;">
                                    <h5>Remaining This Month</h5>
                                    <p><strong>$<span id="thisMonthRequired">0.00</span></strong></p>
                                    <small>Funds needed for remaining pay periods this month</small>
                                </div>
                                <div class="summary-box" style="border-color: #000;">
                                    <h5>Next Month Projection</h5>
                                    <p><strong>$<span id="nextMonthRequired">0.00</span></strong></p>
                                    <small>Projected funds needed for next month's payroll</small>
                                </div>
                            </div>
                            <p><em>Based on <span id="projectedHours">0.0</span> hours per period average for all employees</em></p>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 25px;">
                        <button class="btn btn-primary" id="generatePayStubBtn">Generate Pay Stub</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="settings" class="tab-content">
            <div class="card">
                <div class="card-header">Company Settings</div>
                <div class="card-body" id="companySettingsForm">
                     <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Company Name</label>
                            <input type="text" id="companyName" class="form-input" placeholder="Your Company Name">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tax Year</label>
                            <input type="number" id="taxYear" class="form-input" placeholder="2025" min="2020" max="2030">
                        </div>
                         <div class="form-group">
                            <label class="form-label">Tax Year First Pay Period Start date</label>
                            <input type="date" id="firstPayPeriodStartDate" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Pay Frequency</label>
                            <select id="payFrequency" class="form-input">
                                <option value="weekly">Weekly (52 periods)</option>
                                <option value="bi-weekly">Bi-Weekly (26 periods)</option>
                                <option value="semi-monthly">Semi-Monthly (24 periods)</option>
                                <option value="monthly">Monthly (12 periods)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Days Until Payday <small>(after period end)</small></label>
                            <input type="number" id="daysUntilPayday" class="form-input" placeholder="e.g., 5" value="5">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Company Address</label>
                            <input type="text" id="companyAddress" class="form-input" placeholder="123 Main St, City, ST 12345">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Company Phone</label>
                            <input type="tel" id="companyPhone" class="form-input" placeholder="(555) 555-5555">
                        </div>
                    </div>
                </div>
            </div>
            
             <div class="card">
                <div class="card-header">Tax Settings</div>
                <div class="card-body" id="taxSettingsForm">
                    <h4>Global Tax Rates</h4>
                    <div class="form-grid">
                         <div class="form-group">
                            <label class="form-label">Social Security Rate (%)</label>
                            <input type="number" id="socialSecurity" class="form-input" value="6.2" step="0.1" min="0" max="10">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Medicare Rate (%)</label>
                            <input type="number" id="medicare" class="form-input" value="1.45" step="0.1" min="0" max="5">
                        </div>
                        <div class="form-group">
                            <label class="form-label">SUTA Rate (%) - Employer</label>
                            <input type="number" id="sutaRate" class="form-input" placeholder="2.7" step="0.1" min="0" max="10">
                        </div>
                        <div class="form-group">
                            <label class="form-label">FUTA Rate (%) - Employer</label>
                            <input type="number" id="futaRate" class="form-input" value="0.6" step="0.1" min="0" max="2">
                        </div>
                    </div>
                     <hr style="margin: 20px 0;">
                    <h4>Tax Payment Frequencies</h4>
                     <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Federal Payroll (941)</label>
                            <select id="federalTaxFrequency" class="form-input">
                                <option value="weekly">Weekly</option>
                                <option value="bi-weekly">Bi-Weekly</option>
                                <option value="monthly">Monthly</option>
                                <option value="quarterly">Quarterly</option>
                            </select>
                        </div>
                         <div class="form-group">
                            <label class="form-label">FUTA (940)</label>
                            <select id="futaTaxFrequency" class="form-input">
                                <option value="weekly">Weekly</option>
                                <option value="bi-weekly">Bi-Weekly</option>
                                <option value="quarterly">Quarterly</option>
                                <option value="annual">Annual</option>
                            </select>
                        </div>
                         <div class="form-group">
                            <label class="form-label">SUTA</label>
                            <select id="sutaTaxFrequency" class="form-input">
                                <option value="weekly">Weekly</option>
                                <option value="bi-weekly">Bi-Weekly</option>
                                <option value="quarterly">Quarterly</option>
                                <option value="annual">Annual</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">State Income Tax</label>
                            <select id="stateTaxFrequency" class="form-input">
                                <option value="weekly">Weekly</option>
                                <option value="bi-weekly">Bi-Weekly</option>
                                <option value="monthly">Monthly</option>
                                <option value="quarterly">Quarterly</option>
                                <option value="annual">Annual</option>
                            </select>
                        </div>
                         <div class="form-group">
                            <label class="form-label">Local Tax</label>
                            <select id="localTaxFrequency" class="form-input">
                                <option value="weekly">Weekly</option>
                                <option value="bi-weekly">Bi-Weekly</option>
                                <option value="monthly">Monthly</option>
                                <option value="quarterly">Quarterly</option>
                                <option value="annual">Annual</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">Employee Management</div>
                <div class="card-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Employee List</label>
                            <select id="employeeList" class="form-input">
                                <option value="">Select Employee to Edit...</option>
                            </select>
                        </div>
                    </div>
                    <hr style="margin: 20px 0;">
                    <h4 id="employeeFormTitle">Add New Employee</h4>
                     <form id="employeeForm">
                        <input type="hidden" id="employeeId">
                        
                        <h5>General & Pay</h5>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Employee ID #</label>
                                <input type="text" id="idNumber" class="form-input" placeholder="e.g., 001">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Employee Name</label>
                                <input type="text" id="employeeName" class="form-input" placeholder="Full Name" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Address</label>
                                <input type="text" id="employeeAddress" class="form-input" placeholder="123 Oak St, City, ST 12345">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Regular Hourly Rate ($)</label>
                                <input type="number" id="hourlyRate" class="form-input" placeholder="15.00" step="0.01" min="0" required>
                            </div>
                             <div class="form-group">
                                <label class="form-label">Overtime Rate Multiplier</label>
                                <input type="number" id="overtimeRate" class="form-input" value="1.5" step="0.1" min="1">
                            </div>
                             <div class="form-group">
                                <label class="form-label">Holiday Rate Multiplier</label>
                                <input type="number" id="holidayRate" class="form-input" value="2.0" step="0.1" min="1">
                            </div>
                        </div>

                        <h5>Tax Withholding</h5>
                         <div class="form-grid">
                             <div class="form-group">
                                <label class="form-label">Federal Tax Rate (%)</label>
                                <input type="number" id="federalTax" class="form-input" placeholder="12.0" step="0.1" min="0" max="50" value="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">State Tax Rate (%)</label>
                                <input type="number" id="stateTax" class="form-input" placeholder="5.0" step="0.1" min="0" max="15" value="0">
                            </div>
                             <div class="form-group">
                                <label class="form-label">Local Tax Rate (%)</label>
                                <input type="number" id="localTax" class="form-input" placeholder="1.0" step="0.1" min="0" max="10" value="0">
                            </div>
                        </div>

                        <h5>Leave / Paid Time Off (PTO)</h5>
                        <div class="form-grid">
                             <div class="form-group">
                                <label class="form-label">Annual PTO Accrual Rate (hours)</label>
                                <input type="number" id="ptoAccrualRate" class="form-input" placeholder="e.g., 80" step="1" min="0" value="0">
                            </div>
                             <div class="form-group">
                                <label class="form-label">Current PTO Balance (hours)</label>
                                <input type="number" id="ptoBalance" class="form-input" placeholder="e.g., 25.5" step="0.01" min="0" value="0">
                            </div>
                        </div>

                         <div style="text-align: center;">
                            <button type="submit" class="btn btn-primary">Save Employee</button>
                            <button type="button" class="btn btn-secondary" id="newEmployeeBtn">New Employee</button>
                             <button type="button" class="btn btn-danger" id="deleteEmployeeBtn" style="display:none;">Delete Employee</button>
                        </div>
                    </form>
                </div>
            </div>

            <div class="card">
                <div class="card-header">Data Management</div>
                <div class="card-body" style="text-align: center;">
                    <p>Save a backup of your data to a file or import data from a backup file.</p>
                    <div style="margin-top: 20px; display: flex; justify-content: center; gap: 15px;">
                        <button class="btn btn-success" id="importDataBtn">Import Data</button>
                        <button class="btn btn-warning" id="exportDataBtn">Export Data</button>
                    </div>
                    <div class="alert alert-info" style="margin-top: 20px; text-align: left;">
                        <strong>Note:</strong> Importing data will overwrite all current application data. It's recommended to export a backup first. The application will automatically reload after a successful import.
                    </div>
                </div>
            </div>
        </div>

        <div id="payroll" class="tab-content">
            <div class="card">
                <div class="card-header">Pay Period Data</div>
                <div class="card-body">
                    <p>Showing data for employee: <strong id="payrollTabEmployeeName">None Selected</strong></p>
                    <div style="overflow-x: auto;">
                        <table class="report-table" id="payPeriodsTable">
                            <thead>
                                <tr>
                                    <th>Period #</th>
                                    <th>Start Date</th>
                                    <th>End Date</th>
                                    <th>Pay Date</th>
                                    <th>Total Hours</th>
                                    <th>Gross Pay</th>
                                    <th>Fed Tax</th>
                                    <th>State Tax</th>
                                    <th>Local Tax</th>
                                    <th>FICA</th>
                                    <th>Medicare</th>
                                    <th>Net Pay</th>
                                </tr>
                            </thead>
                            <tbody id="payPeriodsBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div id="paystub" class="tab-content">
            <div class="card">
                <div class="card-header">Generated Pay Stub</div>
                <div class="card-body">
                    <div id="paystubContent" class="paystub">
                        <div class="paystub-header">
                            <div class="company-info">
                                <div class="company-name" id="paystubCompanyName">Your Company LLC</div>
                                <div id="paystubCompanyAddress"></div>
                            </div>
                            
                            <div class="non-negotiable">NON-NEGOTIABLE</div>
                            
                            <div class="pay-info">
                                <div class="employee-info">
                                    <div><strong>PAY TO THE ORDER OF:</strong> <span id="paystubEmployeeName"></span></div>
                                    <div id="paystubEmployeeAddress"></div>
                                    <div><strong>EMPLOYEE ID #:</strong> <span id="paystubEmployeeId"></span></div>
                                </div>
                                
                                <div class="period-info">
                                    <div><strong>Period Start:</strong> <span id="paystubStartDate"></span></div>
                                    <div><strong>Period End:</strong> <span id="paystubEndDate"></span></div>
                                    <div><strong>Check Date:</strong> <span id="paystubPayDate"></span></div>
                                </div>
                            </div>
                        </div>

                        <table class="paystub-table">
                            <thead>
                                <tr>
                                    <th>Earnings Type</th>
                                    <th>Rate</th>
                                    <th>Hours</th>
                                    <th>Current</th>
                                    <th>YTD</th>
                                </tr>
                            </thead>
                            <tbody id="paystubEarningsBody">
                                </tbody>
                            <tfoot>
                                <tr style="font-weight: bold;">
                                    <td>TOTAL EARNINGS</td>
                                    <td></td>
                                    <td class="text-right" id="paystubTotalHours"></td>
                                    <td class="text-right">$<span id="paystubTotalCurrent"></span></td>
                                    <td class="text-right">$<span id="paystubTotalYTD"></span></td>
                                </tr>
                            </tfoot>
                        </table>

                        <div class="totals-section">
                            <div>
                                <div><strong>TAXES</strong></div>
                                <table class="paystub-table">
                                    <thead>
                                        <tr>
                                            <th>Taxes Type</th>
                                            <th>Current</th>
                                            <th>YTD</th>
                                        </tr>
                                    </thead>
                                    <tbody id="paystubTaxesBody">
                                    </tbody>
                                </table>
                            </div>
                            
                            <div>
                                <div class="summary-box">
                                    <div><strong>TOTAL EARNINGS:</strong> $<span id="paystubSummaryGross"></span></div>
                                    <div><strong>TOTAL TAXES:</strong> $<span id="paystubSummaryTaxes"></span></div>
                                    <div><strong>TOTAL DEDUCTIONS:</strong> $0.00</div>
                                </div>
                                
                                <div class="summary-box">
                                    <div><strong>YTD TOTALS</strong></div>
                                    <div>Earnings: $<span id="paystubYTDEarnings"></span></div>
                                    <div>Taxes: $<span id="paystubYTDTaxes"></span></div>
                                    <div>Deductions: $0.00</div>
                                </div>
                            </div>
                        </div>

                        <div class="net-pay">
                            NET PAY: $<span id="paystubNetPay"></span>
                        </div>
                        
                        <div class="pto-summary">
                            <h4>Paid Time Off Summary</h4>
                            <div style="display: flex; justify-content: space-around; text-align: center;">
                                <div><strong>Beginning</strong><br><span id="ptoBegin">0.00</span></div>
                                <div><strong>Earned</strong><br><span id="ptoEarned">0.00</span></div>
                                <div><strong>Used</strong><br><span id="ptoUsed">0.00</span></div>
                                <div><strong>Ending Balance</strong><br><span id="ptoEnd">0.00</span></div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 25px;">
                        <button class="btn btn-secondary" id="printPayStubBtn">Print Pay Stub</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="reports" class="tab-content">
            <div class="card">
                <div class="card-header">Reports & Compliance</div>
                <div class="card-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Report Type</label>
                            <select id="reportType" class="form-input">
                                <option value="" selected disabled>Select Report Type...</option>
                                <option value="taxdeposit">Tax Deposit Report</option>
                                <option value="annual">Annual W-2 Data</option>
                                <option value="941">IRS Form 941 Data (Quarterly)</option>
                                <option value="940">IRS Form 940 Data (Annual)</option>
                                <option value="daterange-employee">Custom: Employee Wages</option>
                                <option value="daterange-employer">Custom: Employer Expenses</option>
                            </select>
                        </div>
                        
                        <div class="form-group" id="reportEmployeeGroup" style="display: none;">
                            <label class="form-label">Select Employee</label>
                            <select id="reportEmployee" class="form-input">
                                <option value="all">All Employees</option>
                            </select>
                        </div>
                        
                        <div class="form-group" id="reportPeriodGroup">
                            </div>
                        
                        <div class="form-group" id="reportDateRangeGroup" style="display: none;">
                            <label class="form-label">Start Date</label>
                            <input type="date" id="reportStartDate" class="form-input">
                             <label class="form-label" style="margin-top:10px;">End Date</label>
                            <input type="date" id="reportEndDateRange" class="form-input">
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-bottom: 25px;">
                        <button class="btn btn-primary" id="generateReportBtn">Generate Report</button>
                    </div>
                    
                    <div id="reportOutput">
                        <div class="alert alert-info">
                            Select a report type and period, then click "Generate Report" to view tax calculations and compliance data.
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="banking" class="tab-content">
            <div class="card">
                <div class="card-header">Bank Register</div>
                <div class="card-body">
                    <div class="card" style="margin-bottom: 30px;">
                        <div class="card-body" style="text-align: center;">
                            <h3 style="margin-bottom: 10px;">Current Balance</h3>
                            <h2 id="currentBalance" style="font-size: 2.5em; color: #28a745;">$0.00</h2>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header" style="background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);">Add New Transaction</div>
                        <div class="card-body">
                            <form id="transactionForm">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="transDate" class="form-label">Date</label>
                                        <input type="date" id="transDate" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="transDesc" class="form-label">Description</label>
                                        <input type="text" id="transDesc" class="form-input" placeholder="e.g., Office Supplies" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="transType" class="form-label">Type</label>
                                        <select id="transType" class="form-input">
                                            <option value="debit">Debit / Withdrawal</option>
                                            <option value="credit">Credit / Deposit</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="transAmount" class="form-label">Amount</label>
                                        <input type="number" id="transAmount" class="form-input" placeholder="50.00" step="0.01" min="0" required>
                                    </div>
                                </div>
                                <div style="text-align: center;">
                                    <button type="submit" class="btn btn-primary">Add Transaction</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div style="overflow-x: auto; margin-top: 30px;">
                        <table class="report-table" id="bankRegisterTable">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Description</th>
                                    <th>Debit</th>
                                    <th>Credit</th>
                                    <th>Balance</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="bankRegisterBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="js/main.js"></script>
</body>
</html>